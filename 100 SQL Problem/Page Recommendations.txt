-- https://www.naukri.com/code360/problems/page-recommendations_2187450?topList=top-100-sql-problems&problemListRedirection=true&count=25&search=&sort_entity=order&sort_order=ASC&attempt_status=NOT_ATTEMPTED&leftPanelTabValue=PROBLEM&customSource=studio_nav&page=2
-- Page Recommendations
with tmp as (
    select user1_id 
    from Friendship 
    where user2_id=1
    union
    select user2_id 
    from Friendship
    where user1_id=1 
),tmp1 as(
    select distinct page_id as recommended_page 
    from Likes
    where user_id in(
        select * from tmp
    )
),tmp2 as(
    select page_id
    from Likes
    where user_id=1
)

select * 
from tmp1
where recommended_page not in (select * from tmp2)
-- order by recommended_page
