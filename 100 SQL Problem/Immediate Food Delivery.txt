-- https://www.naukri.com/code360/problems/immediate-food-delivery_2181193?topList=top-100-sql-problems&problemListRedirection=true&leftPanelTabValue=PROBLEM&count=25&search=&sort_entity=avg_time&sort_order=ASC&attempt_status=NOT_ATTEMPTED&customSource=studio_nav&page=1
-- Immediate Food Delivery
select round(100*avg(case when order_date=customer_pref_delivery_date then 1 else 0 end),2) as immediate_percentage
from delivery
where (customer_id,order_date) in (
    select customer_id,min(order_date) from delivery
    group by customer_id
)