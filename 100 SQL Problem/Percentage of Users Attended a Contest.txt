-- https://www.naukri.com/code360/problems/percentage-of-users-attended-a-contest_2188791?topList=top-100-sql-problems&problemListRedirection=true&count=25&page=3&search=&sort_entity=order&sort_order=ASC&attempt_status=NOT_ATTEMPTED&leftPanelTabValue=PROBLEM&customSource=studio_nav
-- Percentage of Users Attended a Contest

select contest_id,round(count(contest_id)/(select count(*) from Users)*100,2) as percentage 
from Register r
join users u on u.user_id=r.user_id
group by contest_id
order by percentage desc,contest_id asc

or 

WITH contest_counts AS (
    SELECT 
        contest_id,
        COUNT(DISTINCT user_id) AS user_count
    FROM Register
    GROUP BY contest_id
),
total_users AS (
    SELECT COUNT(DISTINCT user_id) AS total
    FROM Users
)
SELECT 
    c.contest_id,
    ROUND((c.user_count * 100.0 / t.total), 2) AS percentage
FROM contest_counts c
CROSS JOIN total_users t
ORDER BY percentage DESC, contest_id ASC;
