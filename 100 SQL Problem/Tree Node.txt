-- https://www.naukri.com/code360/problems/tree-node_2119334?topList=top-100-sql-problems&problemListRedirection=true&count=25&search=&sort_entity=order&sort_order=ASC&attempt_status=NOT_ATTEMPTED&leftPanelTabValue=PROBLEM&customSource=studio_nav&page=2
-- Tree Node

with tmp as (
select id,'Root' as Type
from tree
where p_id is null
union 
select t1.id,'Inner'
from tree t1
join tree t2
on t1.p_id=t2.id
join tree t3
on t3.p_id=t1.id
union 
SELECT t.id, 'Leaf'
FROM tree t
LEFT JOIN tree c ON c.p_id = t.id
WHERE c.p_id IS NULL
)

select * from tmp
order by id
