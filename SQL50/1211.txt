-- https://leetcode.com/problems/queries-quality-and-percentage/?envType=study-plan-v2&envId=top-sql-50
-- 1211. Queries Quality and Percentage
select query_name,round(avg(rating/position),2) as quality,
round(sum(rating<3)/count(query_name)*100,2) as poor_query_percentage 
from Queries 
group by query_name