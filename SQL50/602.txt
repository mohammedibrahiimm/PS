-- https://leetcode.com/problems/friend-requests-ii-who-has-the-most-friends/?envType=study-plan-v2&envId=top-sql-50
-- 602. Friend Requests II: Who Has the Most Friends
with table1 as (select accepter_id as id,count(accepter_id) as num
from RequestAccepted 
group by accepter_id 
union all 
select requester_id  as id,count(requester_id ) as num
from RequestAccepted 
group by requester_id)

select id,sum(num) as num from table1 group by id order by num desc, id asc limit 1