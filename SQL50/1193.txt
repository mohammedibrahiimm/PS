-- https://leetcode.com/problems/monthly-transactions-i/?envType=study-plan-v2&envId=top-sql-50
-- 1193. Monthly Transactions I
select DATE_FORMAT(trans_date,'%Y-%m') as month , country,
count(DATE_FORMAT(trans_date,'%Y-%m')) as trans_count,sum(state='approved') as approved_count,
sum(amount) as trans_total_amount ,sum(case when state = 'approved' then amount else 0 end) as approved_total_amount 
from Transactions
group by month,country