-- https://leetcode.com/problems/confirmation-rate/?envType=study-plan-v2&envId=top-sql-50
-- 1934. Confirmation Rate
select s.user_id,round(sum(case when action='confirmed' then 1 else 0 end)/count(s.user_id),2)as confirmation_rate from Signups s
left outer join Confirmations c on c.user_id = s.user_id
group by user_id